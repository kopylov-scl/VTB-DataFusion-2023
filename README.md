## Применение вариационного автоэнкодера (LSTM-VRAE) для задачи Защита - Data Fusion Contest 2023

## [Data Fusion Contest 2023](https://ods.ai/tracks/data-fusion-2023-competitions)

В задаче требовалось защитить банковскую модель для предсказания дефолта клиента по кредиту от Adversarial ML атак на входные данные.

Датасет предоставлен банком ВТБ.

[Описание задачи](https://ods.ai/tracks/data-fusion-2023-competitions/competitions/data-fusion2023-defence)

#### Описание решения

1) Решение основано на применении модели CatBoost для классификации дефолта пользователя по кредиту
2) Скрытое представление LSTM-VRAE используется в качестве признаков для модели CatBoost
3) Предсказание исходной RNN модели так же используется в качестве признака для модели CatBoost
4) Дополнительная защита для бустинга:
- используются только транзакции по mcc-кодам, которые встречаются более 10 раз, 
- аномальные суммы транзакций по каждому коду заменяются на медианы,
- транзакции по mcc-коду 6012 не учитываются, т.к. частотность и соотношение доходов и расходов по этому коду имеет относительно большое значение для бустинга, а, следовательно, существует возможность атаки бустинг модели по этому коду.
- первые и последние 20 транзакций каждого клиента обрезаются (только для бустинга).
5) В качестве признаков для бустинга дополнительно применяются:
- построчно нормализованные суммы доходов и расходов (отдельно) по каждому mcc-коду,
- извлекаются статистические признаки по частотностям mcc-кодов и по суммам доходов и расходов,
- расширенные временные признаки (частотность mcc-кодов по часам, дням недели, дням месяца).

#### Файлы

- run.py - решение, использующее предобученные модели
- training.ipynb - обучение VRAE и CatBoost

#### Метрика
Mean Harm ROC-AUC. Это среднее гармоническое ROC-AUC на исходных данных и на атакованных. Метрика сочетает в себе компромисс между повышением защищенности модели и потенциальным снижением ее качества. 

